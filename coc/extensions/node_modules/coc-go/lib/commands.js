"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const path_1 = tslib_1.__importDefault(require("path"));
const coc_nvim_1 = require("coc.nvim");
const tools_1 = require("./utils/tools");
const binaries_1 = require("./binaries");
async function version() {
    const v = require(path_1.default.resolve(__dirname, '..', 'package.json')).version;
    let v2 = "unknown";
    const [, goplsOut] = await tools_1.runGoTool("gopls", ["version"]);
    const m = goplsOut.match(/golang\.org\/x\/tools\/gopls (v.*)/);
    if (m) {
        v2 = m[1];
    }
    coc_nvim_1.workspace.showMessage(`Version: coc-go ${v}; gopls ${v2}`, 'more');
}
exports.version = version;
async function installGopls(client) {
    await tools_1.installGoBin(binaries_1.GOPLS, true);
    if (client.needsStop()) {
        await client.stop();
        client.restart();
    }
}
exports.installGopls = installGopls;
async function installGomodifytags() {
    await tools_1.installGoBin(binaries_1.GOMODIFYTAGS, true);
}
exports.installGomodifytags = installGomodifytags;
async function installGotests() {
    await tools_1.installGoBin(binaries_1.GOTESTS, true);
}
exports.installGotests = installGotests;
async function installGoplay() {
    await tools_1.installGoBin(binaries_1.GOPLAY, true);
}
exports.installGoplay = installGoplay;
//# sourceMappingURL=commands.js.map